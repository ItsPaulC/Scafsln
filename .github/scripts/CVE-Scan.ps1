param(
    [string]$initialDirectory = (Get-Location).Path
)

# Import the utility functions
$scriptPath = Split-Path -Parent $MyInvocation.MyCommand.Path
$utilityScriptPath = Join-Path -Path $scriptPath -ChildPath "Utilities.ps1"

# Check if the utility script exists and source it
if (-not (Test-Path -Path $utilityScriptPath)) {
    Write-Error "Required utility script not found: $utilityScriptPath"
    exit 1
}

# Dot source the utility script to import the functions
. $utilityScriptPath


#region Main Script


New-Solution-FromProjectPath -startDir $initialDirectory

$packageListResult = dotnet list $global:ScanSolutionPath package
